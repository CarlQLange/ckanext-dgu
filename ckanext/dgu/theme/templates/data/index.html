<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:py="http://genshi.edgewall.org/"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:strip="">

  <xi:include href="../facets.html" />
  <py:def function="page_title">Data</py:def>


  <py:def function="optional_head">
    <script type="text/javascript" charset="utf-8">
      $(function() {
        /* Tag cloud */
        $.fn.tagcloud.defaults = {
          size: {start: 8, end: 24, unit: "pt"},
          //size: {start: 12, end: 28, unit: "pt"},
          color: {start: '#bbb', end: '#66aa44'}
        };
        $('#tagcloud a').tagcloud();
      });
  </script>
  </py:def>

  <div py:match="content">
    <!--! Though deeply unfashionable... I'm using a table to create equal-height boxes -->
    <div class="row-fluid dgu-equal-height" data-selector=".auto-height">
      <div class="span6">
        <div class="boxed auto-height">
          <h2 class="front-page-header">Search Datasets</h2>
          ${search_form()}
        </div>
      </div>
      <div class="span6">
        <div class="boxed auto-height">
<!--!
          <h2 class="front-page-header">Themes
            <a href="/data/themes" class="btn btn-primary front-page-button">View all themes &raquo;</a>
          </h2>
          <div id="tagcloud" py:with="theme_count=h.themes_count()">
            <py:for each="dbname,displayname in sorted(h.themes_displayname().iteritems(),key=lambda x:x[1])">
            <a rel="${theme_count[dbname]}" title="${displayname}" href="${h.url_for(controller='package', action='search')}?theme-primary=${dbname}">${displayname}</a>
            </py:for>
          </div>
-->
          <h2 class="front-page-header">Tags
              <a href="/data/tag" class="btn btn-primary front-page-button">View all tags &raquo;</a>
          </h2>
          <div id="tagcloud">
            <py:for each="tag_dict in h.random_tags()">
              <a rel="${tag_dict['count']}" title="${tag_dict['count']}" href="/data/search?tags=${tag_dict['name']}">${tag_dict['name']}</a>
            </py:for>
          </div>
          <script type="text/javascript" charset="utf-8">
        </script>
        </div>
      </div>
    </div>
    <div class="space-between-rows"></div>
    <div class="row-fluid dgu-equal-height" data-selector=".auto-height">
      <div class="span6">
        <div class="boxed auto-height">
          <h2 class="front-page-header">Publishers
            <a href="/publisher" class="btn btn-primary front-page-button">View all publishers &raquo;</a>
          </h2>
          <ul class="facet-options">
            <li py:for="publisher_dict in h.unselected_facet_items('publisher', limit=10)">
              <a href="/publisher/${publisher_dict['name']}">${h.group_name_to_title(publisher_dict['name'])}</a> &nbsp;(${publisher_dict['count']})
            </li>
          </ul>
          <p py:if="not len(h.unselected_facet_items('publisher', limit=1))">No publishers found</p>
        </div>
      </div>
      <div class="span6">
        <div class="boxed auto-height">
          <h2 class="front-page-header">UK Location
            <a href="${h.url_for('/data/map-based-search')}" class="btn btn-primary front-page-button">Map-based search &raquo;</a>
          </h2>
          <a href="/location"><img src="/images/uk_location.gif" class="pull-right"/></a>
          <p>The <a href="/location">UK Location Programme</a> has introduced over
             1000 location data records into data.gov.uk and tools to support their
             use. To find which of these datasets cover a particular location, you
             can use <a href="${h.url_for('/data/map-based-search')}">Map Based Search</a>.</p>
             <p>Many of these datasets provide a Web Map Service
             too, and for some a preview of the data is available. Click to find out more
             <a href="/location/map-based-search">about Map Based Search</a>
             and <a href="/location/preview-on-map">about Preview on Map</a>.
          </p>
        </div>
      </div>
    </div>
    <div class="space-between-rows"></div>
    <div class="row-fluid dgu-equal-height" data-selector=".auto-height">
      <div class="span6">
        <div class="boxed auto-height">
          <h2 class="front-page-header">Featured dataset
            <a href="${h.url_for(controller='ckanext.ga_report.controller:GaDatasetReport',action='read')}" class="btn btn-primary front-page-button">Popular datasets &raquo;</a>
          </h2>
          <py:with vars="featured=h.single_popular_dataset(20)">
            <py:if test="featured">
              ${package_summary(featured, show_preview_buttons=False)}
            </py:if>
            <py:if test="not featured">
              <em>The catalogue contains no datasets.</em>
            </py:if>
          </py:with>
        </div>
      </div>
      <div class="span3">
        <div class="boxed auto-height">
          <h2 class="front-page-header">Data Requests</h2>
          <p>Find out more about making data requests and their progress.</p>
          <a href="/odug" class="btn btn-primary front-page-button pull-right">Request new data &raquo;</a>
        </div>
      </div>
      <div class="span3">
        <div class="boxed auto-height">
          <h2 class="front-page-header">Developers</h2>
          <p>You can also access this catalogue via the <a title="API" href="${h.url_for('/data/api')}">API</a> or download it as a&nbsp;<a title="CSV/JSON Dump" href="/data/dumps/">CSV or JSON dump</a>.</p>
          <a href="/data/api" class="btn btn-primary">CKAN API &raquo;</a>
        </div>
      </div>
    </div>
  </div>
  <xi:include href="../layout.html" />

</html>
