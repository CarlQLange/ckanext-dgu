<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:py="http://genshi.edgewall.org/"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:strip="">

  <xi:include href="../facets.html" />
  <py:def function="page_title">Search | data.gov.uk</py:def>
  <py:def function="body_class">no-sidebar</py:def>

  <div py:match="content">
    <div class="row">
      <div class="span12">
        <xi:include href="search_form.html" />
      </div>
      <div class="span3">
        <div id="filter-heading">
          <p>You can refine your search results using the filters below</p>
        </div>

        <div class="facet-box" id="map-based-search">
          <h2>UK Location Map Search</h2>
          <p><a href="${h.url_for_static('/map-based-search')}">Conduct Map Based Search</a></p>
        </div>

        ${facet_filters()}
      </div>
      <div class="offset1 span8">
        ${field_list()}   
          
        <py:if test="c.query_error">
          <p i18n:msg="item_count"><strong>There was an error while searching.</strong> 
              Please try again.</p>
        </py:if>
        <py:if test="request.params">      
          <span class="action">
            ${h.subnav_link(c, h.icon('atom_feed'), controller='package', action='search', format='atom')} <!-- TODO: Make this work! (id=xyz, etc) -->
          </span>
        </py:if>
        <py:if test="c.page.item_count == 0 and request.params">
          <p i18n:msg="">Would you like to <a href="${h.url_for(action='new', id=None)}">create a new dataset?</a></p>
        </py:if>
        ${package_list_from_dict(c.page.items)}
        ${c.page.pager(q=c.q)}
      </div>
    </div>

  </div>
  <xi:include href="layout.html" />
</html>


